import{_ as P,r as _,u as q,i as I,o as a,a as s,b as l,m as i,v as c,f as v,w as C,B as m,q as E,e as u,F as w,d as g,t as b,p as D,j as F}from"./index-zmH8b4zp.js";const r=h=>(D("data-v-dcce5f84"),h=h(),F(),h),M={class:"page__container"},N={key:0},$=r(()=>l("h1",{class:"page__title"},"Авторизация",-1)),j={key:1},L=r(()=>l("h1",{class:"page__title"},"Панель",-1)),O=r(()=>l("h2",{class:"admin__title"},"Создать новый товар",-1)),T={class:"form__create"},z=r(()=>l("label",{for:"type"},"Тип:",-1)),G=r(()=>l("option",{value:"product"},"Продукт",-1)),H=r(()=>l("option",{value:"recipe"},"Рецепт",-1)),J=r(()=>l("option",{value:"box"},"Бокс",-1)),K=[G,H,J],Q=r(()=>l("label",{for:"name"},"Название:",-1)),R={key:0,for:"description"},W={key:2,for:"composition"},X=r(()=>l("label",{for:"price"},"Цена:",-1)),Y={key:4,for:"section"},Z={key:6,for:"structure"},ee=r(()=>l("label",{for:"photo"},"Фотография:",-1)),te=r(()=>l("h2",{class:"admin__title"},"Рецепты",-1)),oe={class:"admin__item-wrapper"},le=r(()=>l("h2",{class:"admin__title"},"Боксы",-1)),ae={class:"admin__item-wrapper"},se={key:0},ne=r(()=>l("h2",{class:"admin__title"},"Товары по секциям",-1)),re={class:"section_name"},ie={class:"admin__item-wrapper"},ue={__name:"AdminView",setup(h){const x=_(""),V=_(""),y=_(!1),f=q(),d=_({}),t=_({type:"product",name:"",description:"",composition:"",price:"",section:"",structure:"",photo:null}),U=async()=>{try{const{success:n}=await f.auth(x.value,V.value);n&&(y.value=!0,localStorage.setItem("isAuthenticated","true"),await k())}catch(n){console.error("Error logging in:",n)}},k=async()=>{try{const n=await f.getAllProduct();d.value=n}catch(n){console.error("Error fetching products:",n)}},B=async()=>{try{const n=new FormData;for(const o in t.value)if(t.value[o]!==null&&t.value[o]!==void 0)if(o==="photos")for(let e=0;e<t.value.photos.length;e++)n.append("photos",t.value.photos[e]);else n.append(o,t.value[o]);await f.createNewProduct(n),await k(),t.value={type:"product",name:"",description:"",composition:"",price:"",section:"",structure:"",photos:[]}}catch(n){console.error("Error creating product:",n)}},A=n=>{const o=n.target.files;o.length&&(t.value.photos=Array.from(o))},S=async(n,o)=>{try{await f.deleteOneProduct(n,o),await k()}catch(e){console.error("Error deleting product:",e)}};return I(async()=>{y.value=!!localStorage.getItem("isAuthenticated"),y.value&&await k()}),(n,o)=>(a(),s("div",M,[y.value?(a(),s("div",j,[L,O,l("form",T,[z,i(l("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>t.value.type=e),required:""},K,512),[[E,t.value.type]]),Q,i(l("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>t.value.name=e),type:"text",placeholder:"Название",required:""},null,512),[[c,t.value.name]]),t.value.type!=="box"?(a(),s("label",R,"Описание:")):u("",!0),t.value.type!=="box"?i((a(),s("textarea",{key:1,"onUpdate:modelValue":o[4]||(o[4]=e=>t.value.description=e),placeholder:"Описание"},null,512)),[[c,t.value.description]]):u("",!0),t.value.type==="product"?(a(),s("label",W,"Состав:")):u("",!0),t.value.type==="product"?i((a(),s("textarea",{key:3,"onUpdate:modelValue":o[5]||(o[5]=e=>t.value.composition=e),placeholder:"Состав (для продуктов)"},null,512)),[[c,t.value.composition]]):u("",!0),X,i(l("input",{"onUpdate:modelValue":o[6]||(o[6]=e=>t.value.price=e),type:"number",placeholder:"Цена",required:""},null,512),[[c,t.value.price]]),t.value.type==="product"?(a(),s("label",Y,"Секция:")):u("",!0),t.value.type==="product"?i((a(),s("input",{key:5,"onUpdate:modelValue":o[7]||(o[7]=e=>t.value.section=e),type:"text",placeholder:"Секция"},null,512)),[[c,t.value.section]]):u("",!0),t.value.type==="box"?(a(),s("label",Z,"Структура:")):u("",!0),t.value.type==="box"?i((a(),s("textarea",{key:7,"onUpdate:modelValue":o[8]||(o[8]=e=>t.value.structure=e),placeholder:"Структура бокса"},null,512)),[[c,t.value.structure]]):u("",!0),ee,l("input",{type:"file",multiple:"",onChange:A},null,32),v(m,{onClick:C(B,["prevent"]),title:"Создать"})]),te,l("div",oe,[(a(!0),s(w,null,g(d.value.recipes,e=>(a(),s("div",{class:"admin__item",key:e.id},[l("p",null,b(e.name),1),v(m,{onClick:p=>S(e.id,"recipe"),title:"удалить"},null,8,["onClick"])]))),128))]),le,l("div",ae,[(a(!0),s(w,null,g(d.value.boxes,e=>(a(),s("div",{class:"admin__item",key:e.id},[l("p",null,b(e.name),1),v(m,{onClick:p=>S(e.id,"box"),title:"удалить"},null,8,["onClick"])]))),128))]),d.value.productsBySections&&d.value.productsBySections.length?(a(),s("div",se,[ne,(a(!0),s(w,null,g(d.value.productsBySections,e=>(a(),s("div",{key:e.section_name},[l("h3",re,b(e.section_name),1),l("div",ie,[(a(!0),s(w,null,g(e.products,p=>(a(),s("div",{class:"admin__item",key:p.id},[l("p",null,b(p.name),1),v(m,{onClick:ce=>S(p.id,"product"),title:"удалить"},null,8,["onClick"])]))),128))])]))),128))])):u("",!0)])):(a(),s("div",N,[$,l("form",{onSubmit:C(U,["prevent"])},[i(l("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>x.value=e),placeholder:"Имя",required:""},null,512),[[c,x.value]]),i(l("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>V.value=e),type:"password",placeholder:"Пароль",required:""},null,512),[[c,V.value]]),v(m,{onClick:C(U,["prevent"]),title:"Вход"})],32)]))]))}},pe=P(ue,[["__scopeId","data-v-dcce5f84"]]);export{pe as default};
